{% extends 'smartadmin/base_admin.html' %}
{% block content %}
<h3>Пользователи системы</h3>

{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }} mt-2">{{ message }}</div>
  {% endfor %}
{% endif %}

<table class="table table-striped table-hover mt-3 align-middle">
  <thead>
    <tr>
      <th>#</th>
      <th>Имя пользователя</th>
      <th>Email</th>
      <th>Роль</th>
      <th>Школа</th>
      <th>Дата регистрации</th>
      <th>Действия</th>
    </tr>
  </thead>
  <tbody>
    {% for u in users %}
    <tr>
      <td>{{ forloop.counter }}</td>
      <td>{{ u.username }}</td>
      <td>{{ u.email }}</td>
      <td>
        {% if u.role == "director" %}
          <span class="badge bg-primary">Директор</span>
        {% elif u.role == "teacher" %}
          <span class="badge bg-success">Учитель</span>
        {% elif u.role == "secretary" %}
          <span class="badge bg-warning text-dark">Секретарь</span>
        {% else %}
          <span class="badge bg-secondary">---</span>
        {% endif %}
      </td>
      <td>
        {% if u.school.name %}
          {{u.school.name}}
        {% else %}
          —
        {% endif %}
      </td>
      <td>{{ u.date_joined|date:"d.m.Y" }}</td>
        <td>
            <a href="{% url 'user_edit' u.id %}" class="btn btn-sm btn-outline-secondary">Редактировать</a>
            <a href="{% url 'user_delete' u.id %}" class="btn btn-sm btn-outline-danger">Удалить</a>
        </td>
    </tr>
    {% empty %}
    <tr><td colspan="6" class="text-center">Нет зарегистрированных пользователей</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
